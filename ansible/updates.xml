---
- hosts: localhost

  tasks:
    - name: Update all pacakges
      dnf:
        name: "*"
        state: latest
      register: result
    - name: Show updated packages output
      when: result is changed
      debug: msg="{{ result.results }}"

    - name: Upgrade all flatpaks
      ansible.builtin.command: 
        flatpak update --noninteractive
      register: result
      changed_when: "'Nothing to do' not in result.stdout"
    - name: Show output
      when: result is changed
      debug: msg="{{ result.stdout_lines }}"

